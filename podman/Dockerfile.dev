# syntax=docker/dockerfile:1.4
# -----------------------------
# Build Args (must be declared before FROM)
ARG NODE_VERSION=22
ARG ANGULAR_VERSION=20

FROM node:${NODE_VERSION}-bookworm

# Re-declare build args after FROM for later use
ARG ANGULAR_VERSION
ARG NODE_VERSION

# Install pnpm + Angular CLI inside container as root
RUN corepack enable && corepack prepare pnpm@latest --activate \
 && npm install -g @angular/cli@${ANGULAR_VERSION}

# Create non-root dev user (vscode)
RUN id -u vscode &>/dev/null || useradd -u 1000 -m vscode
USER 1000:1000
WORKDIR /workspaces/app

# Display Node and Angular versions for traceability
RUN echo "ğŸŸ© Node version: $(node -v)" && echo "ğŸ…°ï¸ Angular CLI version: $(ng version | head -n 1)"

CMD ["sleep", "infinity"]
